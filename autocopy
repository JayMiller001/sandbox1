import tkinter as tk
import pyperclip
import threading
import time

class AutoCopyApp:
    def __init__(self, root):
        self.root = root
        self.root.title("AutoCopy App")
        self.text_area = tk.Text(root, wrap=tk.WORD, height=20, width=50)
        self.text_area.pack()
        self.start_button = tk.Button(root, text="Start Copying", command=self.start_copying)
        self.start_button.pack()
        self.lines = []
        self.current_line_index = 0
        self.is_copying = False
        self.monitor_thread = None

    def monitor_clipboard(self):
        while self.is_copying:
            clipboard_content = pyperclip.paste().strip()
            if self.lines and clipboard_content == self.lines[self.current_line_index]:
                self.current_line_index += 1
                if self.current_line_index < len(self.lines):
                    pyperclip.copy(self.lines[self.current_line_index])
            time.sleep(1)  # Check clipboard every second

    def start_copying(self):
        # Get the text from the Text widget and split it into lines
        raw_text = self.text_area.get("1.0", tk.END)
        self.lines = [line.strip() for line in raw_text.splitlines() if line.strip()]
        self.current_line_index = 0
        if self.lines:
            pyperclip.copy(self.lines[0])
            self.is_copying = True
            self.monitor_thread = threading.Thread(target=self.monitor_clipboard, daemon=True)
            self.monitor_thread.start()

    def stop_copying(self):
        self.is_copying = False

if __name__ == "__main__":
    root = tk.Tk()
    app = AutoCopyApp(root)
    root.mainloop()
